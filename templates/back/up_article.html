{% extends 'back/backend_base.html' %}

{% block content %}
    <div class="layui-fluid">
        <div class="layui-row ">

            <form action="" class="layui-form" method="post">
                {% csrf_token %}
                <h3 style="margin-bottom: 5px">添加随笔</h3>
                <label class="layui-form-label">标题</label>
                <div class="layui-input-block">
                    <input type="text" name="title" required lay-verify="required" placeholder="请输入标题"
                           autocomplete="off"
                           class="layui-input" article_id="{{ article_pk }}" id="title">
                </div>

                <div class="layui-textarea">
                    <textarea id="editor_id" name="content" style="width:700px;height:300px;">

                    </textarea>
                </div>
                <input type="submit" value="提交" class="btn-group-lg btn center-block">
            </form>
        </div>
    </div>

<script charset="utf-8" src="/static/kindeditor/kindeditor-all.js"></script>
<script>
        KindEditor.ready(function(K) {
                window.editor = K.create('#editor_id',{
                    width: '100%',
                height: '500px',
                //resizeType 可以拖动的高度  2时可以拖动改变宽度和高度，1时只能改变高度，0时不能拖动。
                resizeType: 0,
                //上传图片,uploadJson 指的是上传的路径,也就是咱们的路由
                uploadJson:'/upload_img/',
                //添加一些额外的参数
                extraFileUploadParams:{
                    'csrfmiddlewaretoken':'{{ csrf_token }}'
                },
                //修改默认上传文件的名字
                filePostName:'myfile'
                });

        });

        $(function () {
            var id=$('#title').attr('article_id')
            $.ajax({
                url:'/get_article/'+{{ article_pk }},
                type:'get',
                success:function (data) {
                    $('#title').val(data.title)
                    window.editor.html(data.content);
                }
            })
        })
</script>
{% endblock %}